---
title: "Hw4Part2"
date: "2023-02-18"
author: "Rafael Espinosa Castaneda"
output: pdf_document
---

```{r setup, include=TRUE,message=FALSE,warning=FALSE}
# --------------------------Setting the libraries to be used------------------------
library(tidyverse)
library(ggmap)
library(tibble) 
library(spatstat)
```


## Part a


```{r parta, include=TRUE,message=FALSE,warning=FALSE}

pacman::p_load(ggmap, osmdata)
chicago<-get_map(location = getbb("chicago") ,source = "stamen")

chicago_points<-read_csv("/Users/rafa/Documents/Master Austin/MAESTRIA_AUSTIN/Advanced Predictive Models/Hw4/Hw4_data_chicago.xls")

lon_chicago<-chicago_points$lon
lat_chicago<-chicago_points$lat



ggmap(chicago)+
  geom_point(data = chicago_points,
             aes(x = lon, y = lat),
             color = "red",
             size = 2) +
  ggtitle("Chicago City supermarkets") 
```
$$\textbf{ANSWER}$$

If I were to draw the smallest rectangle (axis aligned rectangle, not rotated) on the map that included all supermarket locations; there would be no supermarkets in top right corner because there is water in there.It is not possible to see supermarkets in this location.

## Part b
```{r partb, include=TRUE,message=FALSE,fig.height = 10, fig.width = 5,warning=FALSE}

load("/Users/rafa/Documents/Master Austin/MAESTRIA_AUSTIN/Advanced Predictive Models/Hw4/Hw4Part2Data.RData")



class(markets_ppp)

# exploratory analysis -- scatterplot
plot(markets_ppp, 
     main="Markets locations in Chicago")
```
$$\textbf{ANSWER}$$

1) Looking at the plot, the data looks to NOT follow a regular distribution. We notice variation in the locations of the supermarkets, so is not regularly distributed everywhere.

2) The intensity is not constant everywhere in Chicago. We can notice some gaps at the south of chicago, while in the north there are more markets. Hence the numnber of events per unit area will vary from region to region in the map of Chicago.


## Part c

```{r partc, include=TRUE,message=FALSE,fig.height = 8, fig.width = 4,warning=FALSE}


fit3 <- ppm(markets_ppp, ~ polynom(x, y, 2))

plot(markets_ppp, 
     main="Markets locations in Chicago")
plot(fit3, 
     how = "image", 
     se = FALSE, 
     add=TRUE,
     col = grey(seq(1,0,length=128)))


print("The parameters")
fit3


signif(-3.139597e+04,4)


pred_forcast <- data.frame(x = 443674, y = 4636999)


signif(predict(fit3,type="cif",locations=pred_forcast),4)
```

$$\textbf{ANSWER}$$
The intercept of estimated (log) intensity function is **-31400**


The numerical value of the intensity function at the point (x = 443674, y = 4636999)
 is  **7.706e-07**
